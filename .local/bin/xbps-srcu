#!/bin/bash
# ~/.local/bin/xbps-srcu

curDir=$(pwd)

run_step() {
    local msg="$1"
    shift
    echo -ne "[ ] $msg ...\r"
    "$@" > /dev/null 2>&1
    if [ $? -eq 0 ]; then
        echo -e "[*] $msg ..."
    else
        echo -e "[!] $msg ..."
    fi
}

 run_step "Fetching repository updates" bash -c '
    cd ~/Dokumente/Src/void-packages &&
    git pull &&
    cd srcpkgs/brave-bin && git pull
'

run_step "Updating xbps packages" bash -c '
    cd ~/Dokumente/Src/void-packages &&
    ./xbps-src pkg brave-bin spotify
'

run_step "Cleaning up" ./xbps-src clean

cd "$curDir"
